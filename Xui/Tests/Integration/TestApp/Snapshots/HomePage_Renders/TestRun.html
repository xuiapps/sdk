<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8"><title>Test Run</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: system-ui, sans-serif; height: 100vh; }
    .root { display: grid; grid-template-columns: 200px 1fr; height: 100vh; }
    .sidebar { border-right: 1px solid #ddd; overflow-y: auto; padding: 8px 0; }
    .sidebar-title { padding: 8px 16px; font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #999; }
    .step { display: flex; align-items: center; padding: 6px 16px; cursor: pointer; font-size: 13px; }
    .step:hover { background: #f0f0f0; }
    .step.active { background: #e0e0e0; }
    .badge { width: 20px; flex-shrink: 0; }
    .pass .badge { color: green; }
    .fail .badge { color: red; }
    .label { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .compare { overflow: auto; }
    .compare-content { display: grid; position: relative; min-height: 100%; }
    .layer { grid-area: 1 / 1; display: flex; justify-content: center; align-items: start; padding: 24px 250px; pointer-events: none; user-select: none; }
    .layer svg { border: 1px solid #ddd; }
    .separator { position: absolute; top: 0; bottom: 0; width: 2px; background: #000; z-index: 10; pointer-events: none; }
    .sep-handle { position: absolute; top: 0; bottom: 0; width: 20px; transform: translateX(-50%); z-index: 12; cursor: ew-resize; }
    .sep-label { position: absolute; top: 8px; font-size: 11px; color: #666; z-index: 11; pointer-events: none; user-select: none; }
    #label-left { transform: translateX(-100%); padding-right: 8px; }
    #label-right { padding-left: 8px; }
</style></head>
<body>
<div class="root">
  <div class="sidebar">
    <div class="sidebar-title">Snapshots</div>
    <div class="step pass active" onclick="selectStep(0)">
      <span class="badge">&#10003;</span>
      <span class="label">HomePage</span>
    </div>
  </div>
  <div class="compare" id="compare">
    <div class="compare-content" id="compare-content">
      <div class="layer" id="expected-layer"></div>
      <div class="layer" id="actual-layer"></div>
      <div class="separator" id="separator"></div>
      <div class="sep-handle" id="sep-handle"></div>
      <span class="sep-label" id="label-left">Actual</span>
      <span class="sep-label" id="label-right">Expected</span>
    </div>
  </div>
</div>
<script id="snapshot-data" type="application/json">[
  {"index":1,"name":"HomePage","passed":true,"actual":"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNDAwIiB2aWV3Qm94PSIwIDAgNjAwIDQwMCI+DQogIDx0ZXh0IHg9IjAiIHk9IjAiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9InRleHQtYmVmb3JlLWVkZ2UiIGZvbnQtc2l6ZT0iMjQiIGZvbnQtZmFtaWx5PSJJbnRlciIgZm9udC13ZWlnaHQ9Ilh1aS5Db3JlLkNhbnZhcy5Gb250V2VpZ2h0IiB4bWw6c3BhY2U9InByZXNlcnZlIj5YdWkgU0RLIEV4YW1wbGVzIDwvdGV4dD4NCiAgPHRleHQgeD0iMyIgeT0iMzIuMDQiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9InRleHQtYmVmb3JlLWVkZ2UiIGZvbnQtc2l6ZT0iMTUiIGZvbnQtZmFtaWx5PSJJbnRlciIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+VGV4dE1ldHJpY3M8L3RleHQ+DQogIDx0ZXh0IHg9IjMiIHk9IjU2LjE5IiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJ0ZXh0LWJlZm9yZS1lZGdlIiBmb250LXNpemU9IjE1IiBmb250LWZhbWlseT0iSW50ZXIiIHhtbDpzcGFjZT0icHJlc2VydmUiPlRleHQgTGF5b3V0PC90ZXh0Pg0KICA8dGV4dCB4PSIzIiB5PSI4MC4zNCIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0idGV4dC1iZWZvcmUtZWRnZSIgZm9udC1zaXplPSIxNSIgZm9udC1mYW1pbHk9IkludGVyIiB4bWw6c3BhY2U9InByZXNlcnZlIj5OZXN0ZWQgU3RhY2tzPC90ZXh0Pg0KICA8dGV4dCB4PSIzIiB5PSIxMDQuNDkiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9InRleHQtYmVmb3JlLWVkZ2UiIGZvbnQtc2l6ZT0iMTUiIGZvbnQtZmFtaWx5PSJJbnRlciIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+Vmlld0NvbGxlY3Rpb24gQWxpZ25tZW50PC90ZXh0Pg0KICA8dGV4dCB4PSIzIiB5PSIxMjguNjQiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9InRleHQtYmVmb3JlLWVkZ2UiIGZvbnQtc2l6ZT0iMTUiIGZvbnQtZmFtaWx5PSJJbnRlciIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+QW5pbWF0ZWQgSGVhcnQ8L3RleHQ+DQogIDx0ZXh0IHg9IjMiIHk9IjE1Mi43OSIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0idGV4dC1iZWZvcmUtZWRnZSIgZm9udC1zaXplPSIxNSIgZm9udC1mYW1pbHk9IkludGVyIiB4bWw6c3BhY2U9InByZXNlcnZlIj5UZXh0Qm94IE1WUDwvdGV4dD4NCiAgPHRleHQgeD0iMyIgeT0iMTc2Ljk0IiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJ0ZXh0LWJlZm9yZS1lZGdlIiBmb250LXNpemU9IjE1IiBmb250LWZhbWlseT0iSW50ZXIiIHhtbDpzcGFjZT0icHJlc2VydmUiPkNhbnZhcyBUZXN0czwvdGV4dD4NCjwvc3ZnPg0K","expected":"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNDAwIiB2aWV3Qm94PSIwIDAgNjAwIDQwMCI+DQogIDx0ZXh0IHg9IjAiIHk9IjAiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9InRleHQtYmVmb3JlLWVkZ2UiIGZvbnQtc2l6ZT0iMjQiIGZvbnQtZmFtaWx5PSJJbnRlciIgZm9udC13ZWlnaHQ9Ilh1aS5Db3JlLkNhbnZhcy5Gb250V2VpZ2h0IiB4bWw6c3BhY2U9InByZXNlcnZlIj5YdWkgU0RLIEV4YW1wbGVzIDwvdGV4dD4NCiAgPHRleHQgeD0iMyIgeT0iMzIuMDQiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9InRleHQtYmVmb3JlLWVkZ2UiIGZvbnQtc2l6ZT0iMTUiIGZvbnQtZmFtaWx5PSJJbnRlciIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+VGV4dE1ldHJpY3M8L3RleHQ+DQogIDx0ZXh0IHg9IjMiIHk9IjU2LjE5IiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJ0ZXh0LWJlZm9yZS1lZGdlIiBmb250LXNpemU9IjE1IiBmb250LWZhbWlseT0iSW50ZXIiIHhtbDpzcGFjZT0icHJlc2VydmUiPlRleHQgTGF5b3V0PC90ZXh0Pg0KICA8dGV4dCB4PSIzIiB5PSI4MC4zNCIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0idGV4dC1iZWZvcmUtZWRnZSIgZm9udC1zaXplPSIxNSIgZm9udC1mYW1pbHk9IkludGVyIiB4bWw6c3BhY2U9InByZXNlcnZlIj5OZXN0ZWQgU3RhY2tzPC90ZXh0Pg0KICA8dGV4dCB4PSIzIiB5PSIxMDQuNDkiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9InRleHQtYmVmb3JlLWVkZ2UiIGZvbnQtc2l6ZT0iMTUiIGZvbnQtZmFtaWx5PSJJbnRlciIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+Vmlld0NvbGxlY3Rpb24gQWxpZ25tZW50PC90ZXh0Pg0KICA8dGV4dCB4PSIzIiB5PSIxMjguNjQiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9InRleHQtYmVmb3JlLWVkZ2UiIGZvbnQtc2l6ZT0iMTUiIGZvbnQtZmFtaWx5PSJJbnRlciIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+QW5pbWF0ZWQgSGVhcnQ8L3RleHQ+DQogIDx0ZXh0IHg9IjMiIHk9IjE1Mi43OSIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0idGV4dC1iZWZvcmUtZWRnZSIgZm9udC1zaXplPSIxNSIgZm9udC1mYW1pbHk9IkludGVyIiB4bWw6c3BhY2U9InByZXNlcnZlIj5UZXh0Qm94IE1WUDwvdGV4dD4NCiAgPHRleHQgeD0iMyIgeT0iMTc2Ljk0IiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJ0ZXh0LWJlZm9yZS1lZGdlIiBmb250LXNpemU9IjE1IiBmb250LWZhbWlseT0iSW50ZXIiIHhtbDpzcGFjZT0icHJlc2VydmUiPkNhbnZhcyBUZXN0czwvdGV4dD4NCjwvc3ZnPg0K"}
]</script>
<script>
    const snapshots = JSON.parse(document.getElementById('snapshot-data').textContent);
    const compare = document.getElementById('compare');
    const compareContent = document.getElementById('compare-content');
    const actualLayer = document.getElementById('actual-layer');
    const expectedLayer = document.getElementById('expected-layer');
    const separator = document.getElementById('separator');
    const sepHandle = document.getElementById('sep-handle');
    const labelLeft = document.getElementById('label-left');
    const labelRight = document.getElementById('label-right');
    let currentStep = 0;
    let separatorRatio = 1;

    function decodeBase64(b64) {
        const bytes = Uint8Array.from(atob(b64), c => c.charCodeAt(0));
        return new TextDecoder().decode(bytes);
    }

    function selectStep(index) {
        currentStep = index;
        const w = compareContent.offsetWidth;
        const maxRatio = w > 0 ? (w - 250 + 50) / w : 1;
        separatorRatio = maxRatio;
        document.querySelectorAll('.step').forEach((el, i) => el.classList.toggle('active', i === index));
        updateView();
    }

    function updateView() {
        const step = snapshots[currentStep];
        actualLayer.innerHTML = step.actual ? decodeBase64(step.actual) : '';
        const has = !!step.expected;
        expectedLayer.innerHTML = has ? decodeBase64(step.expected) : '';
        separator.style.display = has ? '' : 'none';
        sepHandle.style.display = has ? '' : 'none';
        labelLeft.style.display = has ? '' : 'none';
        labelRight.style.display = has ? '' : 'none';
        if (has) { updateSeparator(); } else { actualLayer.style.clipPath = 'none'; expectedLayer.style.clipPath = 'none'; }
    }

    function updateSeparator() {
        const w = compareContent.offsetWidth;
        const margin = 250;
        const allowance = 50;
        const minX = margin - allowance;
        const maxX = w - margin + allowance;
        const x = Math.round(Math.max(minX, Math.min(maxX, separatorRatio * w)));
        actualLayer.style.clipPath = `inset(0 ${w - x}px 0 0)`;
        expectedLayer.style.clipPath = `inset(0 0 0 ${x}px)`;
        separator.style.left = x + 'px';
        sepHandle.style.left = x + 'px';
        labelLeft.style.left = x + 'px';
        labelRight.style.left = x + 'px';
    }

    let dragging = false;
    sepHandle.addEventListener('mousedown', (e) => { e.preventDefault(); dragging = true; });
    document.addEventListener('mousemove', (e) => { if (dragging) { e.preventDefault(); moveSeparator(e); } });
    document.addEventListener('mouseup', () => { dragging = false; });

    function moveSeparator(e) {
        const rect = compare.getBoundingClientRect();
        const w = compareContent.offsetWidth;
        const x = e.clientX - rect.left + compare.scrollLeft;
        const margin = 250;
        const allowance = 50;
        const minX = margin - allowance;
        const maxX = w - margin + allowance;
        separatorRatio = Math.max(minX / w, Math.min(maxX / w, x / w));
        updateSeparator();
    }

    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowUp' && currentStep > 0) { selectStep(currentStep - 1); e.preventDefault(); }
        if (e.key === 'ArrowDown' && currentStep < snapshots.length - 1) { selectStep(currentStep + 1); e.preventDefault(); }
    });

    window.addEventListener('resize', () => { if (snapshots[currentStep].expected) updateSeparator(); });
    selectStep(0);
</script>
</body></html>
